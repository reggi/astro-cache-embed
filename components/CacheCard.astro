---
import Card from './Card.astro'
import { cacheSocialCard } from '../controllers/cache_card'
import type { CacheFetchOptions } from '../controllers/cache_fetch'
type Props = CacheFetchOptions & { href: string }

const props = Astro.props
const data = await cacheSocialCard(Astro.props.href, props)

const image = data.ogImage || data.icon
const title = data.twitterTitle || data.title
const description = data.description || data.twitterDescription
const summary = data.twitterCard
const href = data.href
---
<Card
  {...Astro.props}
  image={image}
  href={href}
  title={title}
  description={description}
  summary={summary}
/>